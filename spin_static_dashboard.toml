spin_manifest_version = 2

[application]
name = "shuma-gorath-with-dashboard"
version = "0.1.0"
authors = ["Your Name <your@email.com>"]
description = "Shuma-Gorath: Many-Angled Bot Defence for Fermyon Spin with dashboard."

[[trigger.http]]
route = "/..."
component = "bot-trap"

[[trigger.http]]
route = "/dashboard/..."
component = "dashboard-static"

[component.bot-trap]
source = "src/bot_trap.wasm"
allowed_outbound_hosts = ["http://*", "https://*"]
key_value_stores = ["default"]
environment = { API_KEY = "changeme-supersecret" }

[component.bot-trap.build]
command = "cargo build --target wasm32-wasip1 --release && cp target/wasm32-wasip1/release/shuma_gorath.wasm src/bot_trap.wasm"

[component.dashboard-static]
source = "static-fileserver"
files = ["dashboard/**"]
[component.dashboard-static.build]
command = "echo 'No build needed for static files'"
